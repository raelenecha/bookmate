/reservations/reserved:
  get:
    summary: Get books reserved by the current user
    tags:
      - Reservations
    responses:
      200:
        description: List of reserved books
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Book"
      500:
        description: Server error

/reservations/waitlist:
  get:
    summary: Get waitlisted books for the current user
    tags:
      - Waitlist
    responses:
      200:
        description: List of waitlisted books
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  _id:
                    type: string
                  bookId:
                    $ref: "#/components/schemas/Book"
                  waitlistCount:
                    type: integer
      500:
        description: Server error

/reservations:
  post:
    summary: Reserve a book or join a waitlist
    tags:
      - Reservations
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - bookId
            properties:
              bookId:
                type: string
    responses:
      201:
        description: Reservation created or waitlist joined
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MessageResponse"
      400:
        description: Invalid request

/reservations/return:
  put:
    summary: Return a book
    description: |
      Returns a book currently borrowed by the user.
      - Awards points for returning
      - Applies late penalty if overdue
      - Assigns the book to the next waitlisted user if any
    tags:
      - Reservations
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - bookId
            properties:
              bookId:
                type: string
    responses:
      200:
        description: Book returned successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MessageResponse"
      400:
        description: Missing bookId
      404:
        description: Book not found or not reserved by user
      500:
        description: Server error

/reservations/withdraw/{id}:
  delete:
    summary: Withdraw from a waitlist
    tags:
      - Waitlist
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
        description: Book ID to withdraw from waitlist
    responses:
      200:
        description: Successfully withdrawn from waitlist
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MessageResponse"
      404:
        description: Waitlist record not found
      500:
        description: Server error